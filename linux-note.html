<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2022-08-18 四 19:13 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>linux命令杂记</title>
<meta name="generator" content="Org Mode" />
<link rel="stylesheet" type="text/css" href="org-html-themes/src/bigblow_theme/css/htmlize.css"/>
<link rel="stylesheet" type="text/css" href="org-html-themes/src/bigblow_theme/css/bigblow.css"/>
<link rel="stylesheet" type="text/css" href="org-html-themes/src/bigblow_theme/css/hideshow.css"/>
<script type="text/javascript" src="org-html-themes/src/bigblow_theme/js/jquery-1.11.0.min.js"></script>
<script type="text/javascript" src="org-html-themes/src/bigblow_theme/js/jquery-ui-1.10.2.min.js"></script>
<script type="text/javascript" src="org-html-themes/src/bigblow_theme/js/jquery.localscroll-min.js"></script>
<script type="text/javascript" src="org-html-themes/src/bigblow_theme/js/jquery.scrollTo-1.4.3.1-min.js"></script>
<script type="text/javascript" src="org-html-themes/src/bigblow_theme/js/jquery.zclip.min.js"></script>
<script type="text/javascript" src="org-html-themes/src/bigblow_theme/js/bigblow.js"></script>
<script type="text/javascript" src="org-html-themes/src/bigblow_theme/js/hideshow.js"></script>
<script type="text/javascript" src="org-html-themes/src/lib/js/jquery.stickytableheaders.min.js"></script>
</head>
<body>
<div id="content" class="content">
<h1 class="title">linux命令杂记</h1>
<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#org21baa42">1. git</a>
<ul>
<li><a href="#org5451f19">1.1. 设置/取消代理</a></li>
<li><a href="#org3b9ad6a">1.2. clone 子模块</a></li>
<li><a href="#orga788dc3">1.3. 指定需要克隆的branch</a></li>
</ul>
</li>
<li><a href="#org7036d88">2. du -h 以可读形式显示文件大小</a>
<ul>
<li><a href="#org7833328">2.1. 查看目录下的大文件</a></li>
</ul>
</li>
<li><a href="#orgb1e6427">3. test命令</a></li>
<li><a href="#org4f2f4c7">4. bash脚本的编写</a>
<ul>
<li><a href="#org8093b1d">4.1. <code>set -e</code> 遇到错误就停止</a></li>
</ul>
</li>
<li><a href="#org17133d2">5. pstree 查看进程树</a></li>
<li><a href="#org0474b80">6. strace 追踪程序的系统调用</a></li>
<li><a href="#org1d2e161">7. objdump -D 显示可执行文件/库文件的反汇编</a></li>
<li><a href="#orgce1ed04">8. ldd 显示链接信息</a></li>
<li><a href="#orge41ebc2">9. code2html 的使用</a></li>
<li><a href="#orgba87bfc">10. wget 保存整个网站</a></li>
<li><a href="#orgb03892a">11. 配置apt软件源</a></li>
<li><a href="#org4a2b940">12. 在ArchLinux中安装deb</a></li>
<li><a href="#orga8d3670">13. ssh</a>
<ul>
<li><a href="#org79230e8">13.1. 重启ssh服务</a></li>
<li><a href="#org8b7a112">13.2. 查看ssh服务是否启动</a></li>
</ul>
</li>
<li><a href="#orgd20827e">14. 递归改变文件owner</a></li>
<li><a href="#org893076c">15. 汇编文件(.s)的结构</a></li>
<li><a href="#orga9414da">16. makefile</a>
<ul>
<li><a href="#org2440ed5">16.1. 定义变量</a></li>
<li><a href="#org88debd4">16.2. 伪目标 .PHONY</a></li>
<li><a href="#orgd5928d0">16.3. 为整个项目添加宏定义</a></li>
<li><a href="#orgc51e253">16.4. 为目标链接上库</a></li>
<li><a href="#orga36052a">16.5. 通配符</a></li>
<li><a href="#orgfd861d8">16.6. 函数调用</a>
<ul>
<li><a href="#org3300380">16.6.1. 当前目录下某一类型的所有文件形成的列表</a></li>
<li><a href="#org1dee54e">16.6.2. 将列表中的所有匹配项替换为指定形式</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#orgf8bab67">17. GDB</a>
<ul>
<li><a href="#org26b9242">17.1. 为可执行文件设置环境变量</a></li>
<li><a href="#org9232f62">17.2. 为可执行程序传参</a></li>
<li><a href="#org4e06989">17.3. 显示某文件源代码</a></li>
<li><a href="#orgdff8710">17.4. 添加断点</a></li>
<li><a href="#org3ff999c">17.5. 查看断点</a></li>
<li><a href="#org830be16">17.6. 禁用断点</a></li>
<li><a href="#org83f7021">17.7. 重新启用断点</a></li>
<li><a href="#org3e04b9f">17.8. 删除断点</a></li>
<li><a href="#org68350d9">17.9. 保存断点到文件</a></li>
<li><a href="#orge9dbeeb">17.10. 单步跳过 next</a></li>
<li><a href="#org9b963cd">17.11. 继续执行, 直至遇到断点</a></li>
<li><a href="#org54cb982">17.12. 运行到某处,忽略期间的断点</a></li>
<li><a href="#orgba8fc1b">17.13. 进入到函数内部</a></li>
<li><a href="#orgdf4ecc0">17.14. 从函数中跳出并暂停</a></li>
<li><a href="#orgcd77f4a">17.15. 强制从函数中返回特定值</a></li>
<li><a href="#orgf6a70e9">17.16. 跳转到指定位置继续执行</a></li>
<li><a href="#org5137a10">17.17. 显示当前所有的局部变量</a></li>
<li><a href="#org195675f">17.18. 变量/表达式相关</a>
<ul>
<li><a href="#org2484b2b">17.18.1. 打印变量/表达式</a></li>
<li><a href="#org7651464">17.18.2. 自动显示变量值</a></li>
<li><a href="#org077b009">17.18.3. 取消对变量的自动显示</a></li>
<li><a href="#org0a9020d">17.18.4. 显示变量/表达式类型</a></li>
<li><a href="#orgc42814f">17.18.5. 修改变量的值</a></li>
<li><a href="#org4b3eb1d">17.18.6. 监视某变量的值</a></li>
</ul>
</li>
<li><a href="#orgd6fefc7">17.19. 栈相关</a>
<ul>
<li><a href="#orgfcc057e">17.19.1. 显示堆栈信息: bt</a></li>
<li><a href="#org71760e8">17.19.2. 切换栈帧</a></li>
</ul>
</li>
<li><a href="#org23e627d">17.20. 调试已经运行的程序</a></li>
<li><a href="#org0bea85e">17.21. 检查点</a>
<ul>
<li><a href="#org811e684">17.21.1. 在当前位置添加checkpoint</a></li>
<li><a href="#org4818aac">17.21.2. 查看所有checkpoints</a></li>
<li><a href="#org0ce5489">17.21.3. 删除指定checkpoint</a></li>
</ul>
</li>
<li><a href="#org3ad950c">17.22. 线程</a>
<ul>
<li><a href="#orgff726dc">17.22.1. 显示所有线程</a></li>
<li><a href="#org6598af3">17.22.2. 切换到指定线程</a></li>
</ul>
</li>
<li><a href="#org8b9f7a3">17.23. 以指定格式显示某地址处的内容</a></li>
<li><a href="#orge23547e">17.24. 反向运行</a></li>
</ul>
</li>
<li><a href="#org244be8b">18. CMake</a></li>
</ul>
</div>
</div>



<div id="outline-container-org21baa42" class="outline-2">
<h2 id="org21baa42"><span class="section-number-2">1.</span> git</h2>
<div class="outline-text-2" id="text-1">
</div>
<div id="outline-container-org5451f19" class="outline-3">
<h3 id="org5451f19"><span class="section-number-3">1.1.</span> 设置/取消代理</h3>
<div class="outline-text-3" id="text-1-1">
<div class="org-src-container">
<pre class="src src-bash"><span style="color: #62686E;"># </span><span style="color: #62686E;">&#35774;&#32622;ss</span>
git config --global http.proxy <span style="color: #7bc275;">'socks5://127.0.0.1:1080'</span>

git config --global https.proxy <span style="color: #7bc275;">'socks5://127.0.0.1:1080'</span>

<span style="color: #62686E;"># </span><span style="color: #62686E;">&#35774;&#32622;&#20195;&#29702;</span>
git config --global https.proxy http://127.0.0.1:1080

git config --global https.proxy https://127.0.0.1:1080

<span style="color: #62686E;"># </span><span style="color: #62686E;">&#21462;&#28040;&#20195;&#29702;</span>
git config --global --unset http.proxy

git config --global --unset https.proxy
</pre>
</div>
</div>
</div>

<div id="outline-container-org3b9ad6a" class="outline-3">
<h3 id="org3b9ad6a"><span class="section-number-3">1.2.</span> clone 子模块</h3>
<div class="outline-text-3" id="text-1-2">
<pre class="example">
git submodule update --init --recursive
</pre>
<p>
此命令经常无速度, 可能需要手动clone, 见 <code>.gitmodules</code>
</p>
</div>
</div>




<div id="outline-container-orga788dc3" class="outline-3">
<h3 id="orga788dc3"><span class="section-number-3">1.3.</span> 指定需要克隆的branch</h3>
<div class="outline-text-3" id="text-1-3">
<pre class="example">
git clone  -b fsf-gdb-10.1-with-sim&lt;分支&gt;   https://github.com/riscv-collab/riscv-binutils-gdb.git riscv-gdb&lt;别名&gt;
</pre>
</div>
</div>
</div>


<div id="outline-container-org7036d88" class="outline-2">
<h2 id="org7036d88"><span class="section-number-2">2.</span> du -h 以可读形式显示文件大小</h2>
<div class="outline-text-2" id="text-2">
<div class="org-src-container">
<pre class="src src-sh">$ du -h linux-note.org 

12K     linux-note.org
</pre>
</div>
</div>

<div id="outline-container-org7833328" class="outline-3">
<h3 id="org7833328"><span class="section-number-3">2.1.</span> 查看目录下的大文件</h3>
<div class="outline-text-3" id="text-2-1">
<pre class="example">
du -sh .* * | grep G
</pre>
</div>
</div>
</div>



<div id="outline-container-orgb1e6427" class="outline-2">
<h2 id="orgb1e6427"><span class="section-number-2">3.</span> test命令</h2>
<div class="outline-text-2" id="text-3">
<div class="org-src-container">
<pre class="src src-sh">test <span style="color: #C57BDB; font-weight: bold;">`&#21629;&#20196;`</span> = <span style="color: #7bc275;">'str'</span> 
test <span style="color: #C57BDB; font-weight: bold;">`&#21629;&#20196;`</span> = <span style="color: #7bc275;">'string'</span> -a <span style="color: #C57BDB; font-weight: bold;">`&#21629;&#20196;`</span> = <span style="color: #7bc275;">'string'</span>
test <span style="color: #C57BDB; font-weight: bold;">`&#21629;&#20196;`</span> = <span style="color: #7bc275;">"string"</span> -o <span style="color: #C57BDB; font-weight: bold;">`&#21629;&#20196;`</span> = <span style="color: #7bc275;">'string'</span>
</pre>
</div>

<p>
E.g
</p>
<div class="org-src-container">
<pre class="src src-sh"><span style="color: #62686E;"># </span><span style="color: #62686E;">&#21028;&#26029;&#24403;&#21069;&#24179;&#21488;&#26159;&#21542;&#26159;linux</span>
test <span style="color: #C57BDB; font-weight: bold;">`uname -s`</span> = <span style="color: #7bc275;">'Linux'</span>
<span style="color: #C57BDB;">echo</span> $<span style="color: #DFDFDF;">?</span> <span style="color: #62686E;"># </span><span style="color: #62686E;">&#36820;&#22238;&#38646;&#34920;&#31034;&#26080;&#38169;&#35823;&#21457;&#29983; </span>
</pre>
</div>
</div>
</div>



<div id="outline-container-org4f2f4c7" class="outline-2">
<h2 id="org4f2f4c7"><span class="section-number-2">4.</span> bash脚本的编写</h2>
<div class="outline-text-2" id="text-4">
</div>
<div id="outline-container-org8093b1d" class="outline-3">
<h3 id="org8093b1d"><span class="section-number-3">4.1.</span> <code>set -e</code> 遇到错误就停止</h3>
<div class="outline-text-3" id="text-4-1">
<p>
bash脚本默认行为是忽略错误,继续运行.
在脚本开头设置set -e就会使得: 只要有命令返回值!=0整个脚本的运行就会终止
</p>
</div>
</div>
</div>

<div id="outline-container-org17133d2" class="outline-2">
<h2 id="org17133d2"><span class="section-number-2">5.</span> pstree 查看进程树</h2>
<div class="outline-text-2" id="text-5">
<p>
<code>pstree -ap | grep mysql/redis ...</code>
</p>

<p>
在emacs中的shell运行pstree.
</p>
<pre class="example">
sun@Salted-PC:saltedf.github.io [main] $ pstree -ap | grep emacs

  |           `-emacs,65 -nw .
  |               |   |-grep,217 --color=auto emacs
  |               `-{emacs},66

</pre>
</div>
</div>


<div id="outline-container-org0474b80" class="outline-2">
<h2 id="org0474b80"><span class="section-number-2">6.</span> strace 追踪程序的系统调用</h2>
<div class="outline-text-2" id="text-6">
<p>
用于debug和理解程序的流程.
</p>

<div class="org-src-container">
<pre class="src src-bash">strace -f -s 65535 -i -t -T  -p &lt;pid&gt;    -o &#36755;&#20986;&#25991;&#20214; 
</pre>
</div>

<p>
有时候会输出大量信息, 根本无法分析, 若只是需要特定的系统调用,可以使用 <code>-e trace=</code> 进行过滤, 如:负责读取/接收这类的系统调用.
</p>

<p>
<code>-e trace=recvfrom,read,recv,recvmsg</code>
</p>

<pre class="example">
strace -f -s 65535 -i -t -T -e trace=write,sendto,send  -p &lt;PID&gt; 
</pre>


<p>
统计各个系统调用总耗时:
</p>

<div class="org-src-container">
<pre class="src src-bash">strace -c &lt;&#31243;&#24207;&gt;

strace -c -p &lt;PID&gt;
</pre>
</div>

<p>
结果显示了各个系统调用所花费总时间以及所占百分比, 调用次数, 以及出错次数. 出错越多一般代码质量越差.
</p>
<div class="org-src-container">
<pre class="src src-bash">
% time     seconds  usecs/call     calls    errors syscall
------ ----------- ----------- --------- --------- ----------------
 49.27    0.009506           7      1281           clock_gettime
 18.75    0.003617           9       390           rt_sigprocmask
  9.05    0.001747           9       175           ioctl
  8.12    0.001567          17        92           write
  5.40    0.001042          23        45           pselect6
  2.48    0.000478          28        17           fcntl
  2.38    0.000459          13        35           rt_sigreturn
  1.37    0.000265           6        38           read
  1.37    0.000264           7        35           timerfd_settime
  1.29    0.000249          27         9           poll
  0.37    0.000071          35         2           kill
  0.16    0.000030          15         2           getpid
  0.00    0.000000           0         2           close
  0.00    0.000000           0         2           openat
------ ----------- ----------- --------- --------- ----------------
100.00    0.019295                  2125           total

</pre>
</div>


<p>
代码分析组合拳: strace看关键调用. ==&gt; 用calltree找出关键系统调用的调用关系. ==&gt;用IDE细看这条调用链 
</p>
</div>
</div>


<div id="outline-container-org1d2e161" class="outline-2">
<h2 id="org1d2e161"><span class="section-number-2">7.</span> objdump -D 显示可执行文件/库文件的反汇编</h2>
<div class="outline-text-2" id="text-7">
<div class="org-src-container">
<pre class="src src-bash">objdump -D XXX | less 
</pre>
</div>
<p>
不加less会显示太多!
</p>
</div>
</div>


<div id="outline-container-orgce1ed04" class="outline-2">
<h2 id="orgce1ed04"><span class="section-number-2">8.</span> ldd 显示链接信息</h2>
<div class="outline-text-2" id="text-8">
<div class="org-src-container">
<pre class="src src-sh">$ ldd ./build/udpclient 

        linux-vdso.so.1 (0x00007ffcb2d85000)
        libstdc++.so.6 =&gt; /lib/x86_64-linux-gnu/libstdc++.so.6 (0x00007f4c64e2a000)
        libgcc_s.so.1 =&gt; /lib/x86_64-linux-gnu/libgcc_s.so.1 (0x00007f4c64e0f000)
        libc.so.6 =&gt; /lib/x86_64-linux-gnu/libc.so.6 (0x00007f4c64c1d000)
        libm.so.6 =&gt; /lib/x86_64-linux-gnu/libm.so.6 (0x00007f4c64ace000)
        /lib64/ld-linux-x86-64.so.2 (0x00007f4c65024000)
</pre>
</div>
</div>
</div>


<div id="outline-container-orge41ebc2" class="outline-2">
<h2 id="orge41ebc2"><span class="section-number-2">9.</span> <a href="https://github.com/agentzh/code2ebook/">code2html</a> 的使用</h2>
<div class="outline-text-2" id="text-9">
<p>
先进入项目根目录: 
</p>

<ol class="org-ol">
<li>代码转html</li>
</ol>

<div class="org-src-container">
<pre class="src src-sh">src2html.pl --tab-width 4 --color --cross-reference <span style="color: #7bc275;">\</span>
            --navigator --line-numbers . &lt;&#39033;&#30446;&#21517;&gt;
</pre>
</div>


<ol class="org-ol">
<li>html合成pdf</li>
</ol>
<div class="org-src-container">
<pre class="src src-sh">ebook-convert html_out/index.html llvm_release_1.pdf <span style="color: #7bc275;">\</span>
        --use-profile-size <span style="color: #7bc275;">\</span>
        --paper-size a3 <span style="color: #7bc275;">\</span>
        --pdf-default-font-size 13 <span style="color: #7bc275;">\</span>
        --pdf-mono-font-size 13 <span style="color: #7bc275;">\</span>
        --margin-left 5 --margin-right 5 <span style="color: #7bc275;">\</span>
        --margin-top 5 --margin-bottom 5 <span style="color: #7bc275;">\</span>
        --page-breaks-before=<span style="color: #7bc275;">'/'</span>  
</pre>
</div>
</div>
</div>


<div id="outline-container-orgba87bfc" class="outline-2">
<h2 id="orgba87bfc"><span class="section-number-2">10.</span> wget 保存整个网站</h2>
<div class="outline-text-2" id="text-10">
<p>
<a href="https://github.com/lujun9972/linux-document/blob/master/examples/10%20wget%20command%20examples.org">https://github.com/lujun9972/linux-document/blob/master/examples/10%20wget%20command%20examples.org</a>
</p>

<pre class="example">
wget --mirror --convert-links --page-requisites --no-parent -P /path/to/download https://example-domain.com
</pre>

<p>
但这样可能会下载不全，原因可能有很多。这里遇到的问题是默认是不跨域名下载的。
</p>


<p>
需要运行第二次，并附加上多个选项 
</p>

<pre class="example">
wget --mirror --convert-links -r -D "www.seas.upenn.edu,www.cis.upenn.edu"  -A.pdf -A.zip -A.shtml --tries=1 --timeout=8  --span-hosts  -l 5  --page-requisites --no-parent -P ./  https://www.seas.upenn.edu/\~cis341/17sp/  
</pre>


<ul class="org-ul">
<li>-A 指定那些没有被下载的文件类型 （需要观察网站特征获知）</li>

<li>&#x2013;span-hosts 跨主机名下载。</li>

<li>-D 指定域名/主机名 list，否则将遍历大量无用的域名（需要观察网站特征获知）</li>

<li>&#x2013;tries=1 重试一次，因为有些域名无法访问，也不含要下载的文件。</li>

<li>&#x2013;timeout=10 设定超时时间，防止等待太长时间。</li>
</ul>
</div>
</div>



<div id="outline-container-orgb03892a" class="outline-2">
<h2 id="orgb03892a"><span class="section-number-2">11.</span> 配置apt软件源</h2>
<div class="outline-text-2" id="text-11">
<div class="org-src-container">
<pre class="src src-bash">sudo vim /etc/apt/source.list

sudo apt-get update
</pre>
</div>
</div>
</div>





<div id="outline-container-org4a2b940" class="outline-2">
<h2 id="org4a2b940"><span class="section-number-2">12.</span> 在ArchLinux中安装deb</h2>
<div class="outline-text-2" id="text-12">
<div class="org-src-container">
<pre class="src src-sh">yay -Sy dpkg

dpkg -i  xxx.deb
</pre>
</div>
</div>
</div>


<div id="outline-container-orga8d3670" class="outline-2">
<h2 id="orga8d3670"><span class="section-number-2">13.</span> ssh</h2>
<div class="outline-text-2" id="text-13">
</div>
<div id="outline-container-org79230e8" class="outline-3">
<h3 id="org79230e8"><span class="section-number-3">13.1.</span> 重启ssh服务</h3>
<div class="outline-text-3" id="text-13-1">
<div class="org-src-container">
<pre class="src src-bash">sudo service ssh restart
</pre>
</div>
</div>
</div>






<div id="outline-container-org8b7a112" class="outline-3">
<h3 id="org8b7a112"><span class="section-number-3">13.2.</span> 查看ssh服务是否启动</h3>
<div class="outline-text-3" id="text-13-2">
<div class="org-src-container">
<pre class="src src-bash">sudo lsof -i :22 
</pre>
</div>
</div>
</div>
</div>





<div id="outline-container-orgd20827e" class="outline-2">
<h2 id="orgd20827e"><span class="section-number-2">14.</span> 递归改变文件owner</h2>
<div class="outline-text-2" id="text-14">
<div class="org-src-container">
<pre class="src src-bash">chown -R sun:sun ./dir
</pre>
</div>
</div>
</div>




<div id="outline-container-org893076c" class="outline-2">
<h2 id="org893076c"><span class="section-number-2">15.</span> 汇编文件(.s)的结构</h2>
<div class="outline-text-2" id="text-15">
<pre class="example">
.text: 代码段
.data: 常量 字符串 初始化的全局变量
.bss: 不占用实际空间, 仅仅标记那些局部变量和未初始化的全局变量.
</pre>


<p>
因为已知初值的且生命周期长的变量才有提前为它们分配空间的必要,因此data段才占用空间. bss段中记录的是局部变量/未初始化的全局变量, 没必要一开始就为这些量准备好空间, 只要在程序实际运行时为其准备空间即可. 
</p>
</div>
</div>







<div id="outline-container-orga9414da" class="outline-2">
<h2 id="orga9414da"><span class="section-number-2">16.</span> makefile</h2>
<div class="outline-text-2" id="text-16">
</div>
<div id="outline-container-org2440ed5" class="outline-3">
<h3 id="org2440ed5"><span class="section-number-3">16.1.</span> 定义变量</h3>
<div class="outline-text-3" id="text-16-1">
<div class="org-src-container">
<pre class="src src-makefile"><span style="color: #DFDFDF;">CC</span> := gcc <span style="color: #62686E;"># </span><span style="color: #62686E;">&#23450;&#20041;&#24120;&#37327;, &#21518;&#32493;&#19981;&#33021;&#29992;+=</span>
<span style="color: #DFDFDF;">OBJS</span> = hello.o world.o <span style="color: #62686E;"># </span><span style="color: #62686E;">&#23450;&#20041;&#21464;&#37327;, &#21518;&#32493;&#21487;&#20197;&#29992;+=&#22686;&#21152;</span>
<span style="color: #DFDFDF;">ObJS</span> += fuck.o  
</pre>
</div>
</div>
</div>





<div id="outline-container-org88debd4" class="outline-3">
<h3 id="org88debd4"><span class="section-number-3">16.2.</span> 伪目标 .PHONY</h3>
<div class="outline-text-3" id="text-16-2">
<p>
通常是指那些不生成文件的. 只负责执行某些命令的.
</p>


<div class="org-src-container">
<pre class="src src-makefile"><span style="color: #51afef;">.PHONY</span>: clean  <span style="color: #62686E;"># </span><span style="color: #62686E;">&#36825;&#20010;&#20043;&#21518;&#30340;target&#37117;&#26159;&#20266;&#30446;&#26631;</span>

<span style="color: #51afef;">clean</span>: 
        <span style="color: #FCCE7B;">-</span>${<span style="color: #DFDFDF;">RM</span>} *.o ${<span style="color: #DFDFDF;">target</span>}
        echo <span style="color: #7bc275;">"finish"</span>

</pre>
</div>
</div>
</div>






<div id="outline-container-orgd5928d0" class="outline-3">
<h3 id="orgd5928d0"><span class="section-number-3">16.3.</span> 为整个项目添加宏定义</h3>
<div class="outline-text-3" id="text-16-3">
<div class="org-src-container">
<pre class="src src-makefile">
<span style="color: #DFDFDF;">DEFS</span> = -D_DEBUG -D_POSIX_SOURCE

<span style="color: #DFDFDF;">FLAGS</span> = -g ${<span style="color: #DFDFDF;">DEFS</span>}

</pre>
</div>
</div>
</div>






<div id="outline-container-orgc51e253" class="outline-3">
<h3 id="orgc51e253"><span class="section-number-3">16.4.</span> 为目标链接上库</h3>
<div class="outline-text-3" id="text-16-4">
<div class="org-src-container">
<pre class="src src-makefile"><span style="color: #DFDFDF;">LIBS</span> = -lpthread -lqt

</pre>
</div>
</div>
</div>






<div id="outline-container-orga36052a" class="outline-3">
<h3 id="orga36052a"><span class="section-number-3">16.5.</span> 通配符</h3>
<div class="outline-text-3" id="text-16-5">
<div class="org-src-container">
<pre class="src src-bash">* &#25152;&#26377;
% :&#20219;&#24847;&#19968;&#20010;&#25991;&#20214;
? :
</pre>
</div>




<div class="org-src-container">
<pre class="src src-bash">$<span style="color: #DFDFDF;">@</span> &#30446;&#26631;
$^ &#20840;&#37096;&#30340;&#20381;&#36182;&#25991;&#20214;
$&lt; &#39318;&#20010;&#20381;&#36182;&#39033; 
</pre>
</div>





<div class="org-src-container">
<pre class="src src-makefile"><span style="color: #51afef;">${</span><span style="color: #51afef;">target</span><span style="color: #51afef;">}</span> : ${<span style="color: #DFDFDF;">OBJS</span>}
        ${<span style="color: #DFDFDF;">CC</span>} ${<span style="color: #DFDFDF;">FLAGS</span>} -o <span style="color: #51afef;">$</span><span style="color: #a991f1;">@</span> $<span style="color: #a991f1;">^</span> ${<span style="color: #DFDFDF;">LIBS</span>}


<span style="color: #51afef;">%.o</span> : %.c
        ${<span style="color: #DFDFDF;">CC</span>} -o <span style="color: #51afef;">$</span><span style="color: #a991f1;">@</span>  $<span style="color: #a991f1;">^</span> 
</pre>
</div>
</div>
</div>







<div id="outline-container-orgfd861d8" class="outline-3">
<h3 id="orgfd861d8"><span class="section-number-3">16.6.</span> 函数调用</h3>
<div class="outline-text-3" id="text-16-6">
<div class="org-src-container">
<pre class="src src-makefile">$(<span style="color: #DFDFDF;">my_func</span> arg1,arg2,arg3)
</pre>
</div>
</div>



<div id="outline-container-org3300380" class="outline-4">
<h4 id="org3300380"><span class="section-number-4">16.6.1.</span> 当前目录下某一类型的所有文件形成的列表</h4>
<div class="outline-text-4" id="text-16-6-1">
<div class="org-src-container">
<pre class="src src-makefile"><span style="color: #DFDFDF;">SRC</span> = $(<span style="color: #DFDFDF;">wildcard</span> *.c)  ==&gt; hello.c world.c fuck.c  
</pre>
</div>
</div>
</div>





<div id="outline-container-org1dee54e" class="outline-4">
<h4 id="org1dee54e"><span class="section-number-4">16.6.2.</span> 将列表中的所有匹配项替换为指定形式</h4>
<div class="outline-text-4" id="text-16-6-2">
<div class="org-src-container">
<pre class="src src-makefile"><span style="color: #DFDFDF;">OBJS</span> = $(<span style="color: #DFDFDF;">patsubset</span> %.c,%.o,${<span style="color: #DFDFDF;">SRC</span>} ) 

<span style="color: #62686E;"># </span><span style="color: #62686E;">&#23558; SRC = hello.c fuck.c &#26367;&#25442;&#25104; hello.o fuck.o </span>
</pre>
</div>
</div>
</div>
</div>
</div>








<div id="outline-container-orgf8bab67" class="outline-2">
<h2 id="orgf8bab67"><span class="section-number-2">17.</span> GDB</h2>
<div class="outline-text-2" id="text-17">
<p>
gef/cgdb/emacs gdb-many-windows
</p>
</div>

<div id="outline-container-org26b9242" class="outline-3">
<h3 id="org26b9242"><span class="section-number-3">17.1.</span> 为可执行文件设置环境变量</h3>
<div class="outline-text-3" id="text-17-1">
<p>
set environment FOO = XX 
unset environment FOO
</p>
</div>
</div>

<div id="outline-container-org9232f62" class="outline-3">
<h3 id="org9232f62"><span class="section-number-3">17.2.</span> 为可执行程序传参</h3>
<div class="outline-text-3" id="text-17-2">
<ul class="org-ul">
<li>进入gdb shell后:</li>
</ul>

<p>
<code>run arg1 arg2 ...</code>
</p>

<p>
<code>set args arg1 arg2 arg3</code>
</p>

<ul class="org-ul">
<li>启动gdb时通过命令行传参:</li>
</ul>

<p>
<code>gdb ./main --args ./main a1 a2 a3 ...</code>
</p>

<p>
这种方式需要额外再写一次可执行文件的路径.
</p>
</div>
</div>




<div id="outline-container-org4e06989" class="outline-3">
<h3 id="org4e06989"><span class="section-number-3">17.3.</span> 显示某文件源代码</h3>
<div class="outline-text-3" id="text-17-3">
<div class="org-src-container">
<pre class="src src-bash">l / list &lt;&#20989;&#25968;&gt; 
</pre>
</div>

<p>
默认显示10行
</p>


<p>
当有多个文件时, 为了显示其中一个文件要在文件名后加 <code>:N</code> , 否则会被视作函数名. 
</p>
<pre class="example">
list myfile.cc:1
</pre>
</div>
</div>



<div id="outline-container-orgdff8710" class="outline-3">
<h3 id="orgdff8710"><span class="section-number-3">17.4.</span> 添加断点</h3>
<div class="outline-text-3" id="text-17-4">
<p>
用break可以添加断点, 既能在指定行上添加, 也能为指定函数添加断点.(经常用在一行中有多个函数时)
</p>

<div class="org-src-container">
<pre class="src src-gdb">break myfile.cc:100
=====================
break myfunc
</pre>
</div>
</div>
</div>

<div id="outline-container-org3ff999c" class="outline-3">
<h3 id="org3ff999c"><span class="section-number-3">17.5.</span> 查看断点</h3>
<div class="outline-text-3" id="text-17-5">
<p>
显示了断点是否被禁用, 以及断点打在何处. 每个断点都有一个ID, 对断点的操作都基于此ID
</p>
<pre class="example">

(gdb) info breakpoints
Num     Type           Disp Enb Address            What
1       breakpoint     keep y   0x0000000000408d60 in test_scanner_hello_Test::TestBody() at /home/sun/src/my_compiler/mytest/test_scanner.cc:10
</pre>
</div>
</div>

<div id="outline-container-org830be16" class="outline-3">
<h3 id="org830be16"><span class="section-number-3">17.6.</span> 禁用断点</h3>
<div class="outline-text-3" id="text-17-6">
<div class="org-src-container">
<pre class="src src-gdb">(gdb) disable breakpoints 4 
(gdb) i b
Num     Type           Disp Enb Address            What
4       breakpoint     keep n   0x0000000000408d60 in test_scanner_hello_Test::TestBody() at /home/sun/src/my_compiler/mytest/test_scanner.cc:10

</pre>
</div>
</div>
</div>

<div id="outline-container-org83f7021" class="outline-3">
<h3 id="org83f7021"><span class="section-number-3">17.7.</span> 重新启用断点</h3>
<div class="outline-text-3" id="text-17-7">
<pre class="example">
(gdb) enable 4
(gdb) i b 
Num     Type           Disp Enb Address            What
4       breakpoint     keep y   0x0000000000408d60 in test_scanner_hello_Test::TestBody() at /home/sun/src/my_compiler/mytest/test_scanner.cc:10
</pre>
</div>
</div>

<div id="outline-container-org3e04b9f" class="outline-3">
<h3 id="org3e04b9f"><span class="section-number-3">17.8.</span> 删除断点</h3>
<div class="outline-text-3" id="text-17-8">
<p>
用断点序号指定要删除的断点
</p>
<div class="org-src-container">
<pre class="src src-gdb">(gdb) delete breakpoints 1
</pre>
</div>
</div>
</div>


<div id="outline-container-org68350d9" class="outline-3">
<h3 id="org68350d9"><span class="section-number-3">17.9.</span> 保存断点到文件</h3>
<div class="outline-text-3" id="text-17-9">
<p>
这个功能本身很简陋, 使用前提是源代码不能修改过.
save breakpoints myfile
</p>

<p>
恢复断点:
source &lt;myfile&gt;
</p>
</div>
</div>




<div id="outline-container-orge9dbeeb" class="outline-3">
<h3 id="orge9dbeeb"><span class="section-number-3">17.10.</span> 单步跳过 next</h3>
<div class="outline-text-3" id="text-17-10">
<p>
不会进入函数内部.
</p>
</div>
</div>

<div id="outline-container-org9b963cd" class="outline-3">
<h3 id="org9b963cd"><span class="section-number-3">17.11.</span> 继续执行, 直至遇到断点</h3>
<div class="outline-text-3" id="text-17-11">
<p>
continue
</p>
</div>
</div>

<div id="outline-container-org54cb982" class="outline-3">
<h3 id="org54cb982"><span class="section-number-3">17.12.</span> 运行到某处,忽略期间的断点</h3>
<div class="outline-text-3" id="text-17-12">
<p>
until &lt;N行&gt; 运行下面N行, 忽略之间的断点.
</p>
</div>
</div>

<div id="outline-container-orgba8fc1b" class="outline-3">
<h3 id="orgba8fc1b"><span class="section-number-3">17.13.</span> 进入到函数内部</h3>
<div class="outline-text-3" id="text-17-13">
<p>
step
</p>
</div>
</div>

<div id="outline-container-orgdf4ecc0" class="outline-3">
<h3 id="orgdf4ecc0"><span class="section-number-3">17.14.</span> 从函数中跳出并暂停</h3>
<div class="outline-text-3" id="text-17-14">
<p>
finish
</p>
</div>
</div>



<div id="outline-container-orgcd77f4a" class="outline-3">
<h3 id="orgcd77f4a"><span class="section-number-3">17.15.</span> 强制从函数中返回特定值</h3>
<div class="outline-text-3" id="text-17-15">
<p>
return 
相当于一种特殊的jump, 并不会将函数体执行完.并指定一个返回值
</p>
</div>
</div>
<div id="outline-container-orgf6a70e9" class="outline-3">
<h3 id="orgf6a70e9"><span class="section-number-3">17.16.</span> 跳转到指定位置继续执行</h3>
<div class="outline-text-3" id="text-17-16">
<p>
jump linenum 
</p>

<p>
跳转后不会自动暂停, 需要断点.
</p>
</div>
</div>

<div id="outline-container-org5137a10" class="outline-3">
<h3 id="org5137a10"><span class="section-number-3">17.17.</span> 显示当前所有的局部变量</h3>
<div class="outline-text-3" id="text-17-17">
<p>
info loacls
</p>
</div>
</div>
<div id="outline-container-org195675f" class="outline-3">
<h3 id="org195675f"><span class="section-number-3">17.18.</span> 变量/表达式相关</h3>
<div class="outline-text-3" id="text-17-18">
</div>
<div id="outline-container-org2484b2b" class="outline-4">
<h4 id="org2484b2b"><span class="section-number-4">17.18.1.</span> 打印变量/表达式</h4>
<div class="outline-text-4" id="text-17-18-1">
<div class="org-src-container">
<pre class="src src-gdb">(gdb)  print tk.kind_
$2 = mycompiler::Token::INT
</pre>
</div>
</div>
</div>

<div id="outline-container-org7651464" class="outline-4">
<h4 id="org7651464"><span class="section-number-4">17.18.2.</span> 自动显示变量值</h4>
<div class="outline-text-4" id="text-17-18-2">
<p>
display
每次都将这些变量的值打印处理.
</p>

<pre class="example">
(gdb) info display
Auto-display expressions now in effect:
Num Enb Expression
1:   y  tk.kind_
</pre>
</div>
</div>

<div id="outline-container-org077b009" class="outline-4">
<h4 id="org077b009"><span class="section-number-4">17.18.3.</span> 取消对变量的自动显示</h4>
<div class="outline-text-4" id="text-17-18-3">
<p>
undisplay + N
</p>
</div>
</div>





<div id="outline-container-org0a9020d" class="outline-4">
<h4 id="org0a9020d"><span class="section-number-4">17.18.4.</span> 显示变量/表达式类型</h4>
<div class="outline-text-4" id="text-17-18-4">
<p>
用what/whatis
</p>
<div class="org-src-container">
<pre class="src src-gdb">(gdb) what tk.kind_
type = mycompiler::Token::Kind
(gdb) what 1+3
type = int
(gdb) whatis tk.kind_
type = mycompiler::Token::Kind
</pre>
</div>
</div>
</div>

<div id="outline-container-orgc42814f" class="outline-4">
<h4 id="orgc42814f"><span class="section-number-4">17.18.5.</span> 修改变量的值</h4>
<div class="outline-text-4" id="text-17-18-5">
<p>
可以在不修改源码的情况下对一些值进行设置.
</p>

<pre class="example">
(gdb) set var tk.kind_ = mycompiler::Token::END
</pre>
</div>
</div>



<div id="outline-container-org4b3eb1d" class="outline-4">
<h4 id="org4b3eb1d"><span class="section-number-4">17.18.6.</span> 监视某变量的值</h4>
<div class="outline-text-4" id="text-17-18-6">
<p>
只要这个值发生改变就会自动暂停,并显示新值和旧值.
</p>

<p>
watch tk.kind_
</p>


<p>
显示所有watchpoints
info watchpoints
</p>
</div>
</div>
</div>




<div id="outline-container-orgd6fefc7" class="outline-3">
<h3 id="orgd6fefc7"><span class="section-number-3">17.19.</span> 栈相关</h3>
<div class="outline-text-3" id="text-17-19">
</div>
<div id="outline-container-orgfcc057e" class="outline-4">
<h4 id="orgfcc057e"><span class="section-number-4">17.19.1.</span> 显示堆栈信息: bt</h4>
</div>



<div id="outline-container-org71760e8" class="outline-4">
<h4 id="org71760e8"><span class="section-number-4">17.19.2.</span> 切换栈帧</h4>
<div class="outline-text-4" id="text-17-19-2">
<p>
up/down: 上一层栈帧/下一层栈帧
</p>

<p>
frame N 切换到指定栈帧中
</p>
</div>
</div>
</div>


<div id="outline-container-org23e627d" class="outline-3">
<h3 id="org23e627d"><span class="section-number-3">17.20.</span> 调试已经运行的程序</h3>
<div class="outline-text-3" id="text-17-20">
<p>
首先需要获得其进程pid
</p>

<p>
attach PID
</p>

<p>
detach
</p>
</div>
</div>


<div id="outline-container-org0bea85e" class="outline-3">
<h3 id="org0bea85e"><span class="section-number-3">17.21.</span> 检查点</h3>
<div class="outline-text-3" id="text-17-21">
<p>
通过fork出新的进程来保存当前运行位置和状态.
</p>
</div>

<div id="outline-container-org811e684" class="outline-4">
<h4 id="org811e684"><span class="section-number-4">17.21.1.</span> 在当前位置添加checkpoint</h4>
<div class="outline-text-4" id="text-17-21-1">
<p>
checkpoint 
</p>
</div>
</div>


<div id="outline-container-org4818aac" class="outline-4">
<h4 id="org4818aac"><span class="section-number-4">17.21.2.</span> 查看所有checkpoints</h4>
<div class="outline-text-4" id="text-17-21-2">
<p>
info checkpoints
</p>
</div>
</div>


<div id="outline-container-org0ce5489" class="outline-4">
<h4 id="org0ce5489"><span class="section-number-4">17.21.3.</span> 删除指定checkpoint</h4>
<div class="outline-text-4" id="text-17-21-3">
<p>
delete checkpoint N
</p>
</div>
</div>
</div>






<div id="outline-container-org3ad950c" class="outline-3">
<h3 id="org3ad950c"><span class="section-number-3">17.22.</span> 线程</h3>
<div class="outline-text-3" id="text-17-22">
</div>
<div id="outline-container-orgff726dc" class="outline-4">
<h4 id="orgff726dc"><span class="section-number-4">17.22.1.</span> 显示所有线程</h4>
<div class="outline-text-4" id="text-17-22-1">
<p>
info threads
</p>
</div>
</div>

<div id="outline-container-org6598af3" class="outline-4">
<h4 id="org6598af3"><span class="section-number-4">17.22.2.</span> 切换到指定线程</h4>
<div class="outline-text-4" id="text-17-22-2">
<p>
thread N
</p>
</div>
</div>
</div>






<div id="outline-container-org8b9f7a3" class="outline-3">
<h3 id="org8b9f7a3"><span class="section-number-3">17.23.</span> 以指定格式显示某地址处的内容</h3>
<div class="outline-text-3" id="text-17-23">
<p>
x/格式+长度 &lt;地址&gt;
</p>
</div>
</div>



<div id="outline-container-orge23547e" class="outline-3">
<h3 id="orge23547e"><span class="section-number-3">17.24.</span> 反向运行</h3>
<div class="outline-text-3" id="text-17-24">
<p>
记录反向运行所需信息
</p>

<p>
target record-full 
</p>


<p>
reverse-next
reverse-XXX
</p>
</div>
</div>
</div>



<div id="outline-container-org244be8b" class="outline-2">
<h2 id="org244be8b"><span class="section-number-2">18.</span> <a href="./cmake-learning.html">CMake</a></h2>
</div>
</div>
</body>
</html>
